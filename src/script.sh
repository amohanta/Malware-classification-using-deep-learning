#!/bin/bash
#How to run: ./script.sh <File>
#This script 1.filters the name of the functions present in the import address table and stores them in file 'in'
#2. stores output of readpe -HdS <File> in "out"

#Run:
#1)iatFunctionHash.py after running this script(default input file is 'in')
#2)headerHash.py after running this script(default input file is out)
$(rm -f in out*)
$(readpe -i $1 > out) 
$(awk '{print $1}' out | grep -v .dll > in)
$(rm -f out)
$(sed -i 's/Imported//g' in )
$(sed -i 's/[0-9]*//g' in) 
$(sed -i 's/[_]*//g' in)
$(sed -i '/^$/d' in)   
#
$(readpe -HdS $1 > outH)
$(pestr -n 6 $1 > outS)
#if __name__ == "__main__":
#    main()
