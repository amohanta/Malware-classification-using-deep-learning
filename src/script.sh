#!/bin/bash
#How to run: ./script.sh <File>
#This script
#1. filters the name of the functions present in the import address table and stores them in file 'otF'
#2. stores output of readpe -HdS <File> in "outH"
#3. stores strings of length 6 or more i.e. output of pestr -n 6 <File> in "outS"

in=$1'IN'
outF=$1'OutF'
outH=$1'OutH'
outS=$1'OutS'

if [ 0 -eq 0 ]; then
	$(readpe -i $1 > $in)
	$(sed -e '/[dll]$/d' -e '/Imported/d' -e 's/[_]*//g' -e '/^$/d' $in | awk '{print $1}' | grep -v ^[0-9] > $outF)
	$(readpe -HdS $1 > $outH)
	$(pestr -n 6 $1 > $outS)
fi
