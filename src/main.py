#! /usr/bin/python
import byteStats
import stringHash
import headerHash
import iatFunctionHash
import subprocess
import shutil
from subprocess import call
from os import listdir
from os.path import isfile, join

fout = open("outputFV", 'wb')

fileList = [file for file in listdir("../MalwareSet1") if isfile(join("../MalwareSet1", file))]

for file in fileList:
	file1 = "../MalwareSet1/"+ file
	print file1
	shutil.copy2(file1, './')

	call(["./script.sh", file])

	fv1 = iatFunctionHash.iatFunctionHash(file+'OutF')
	#call(["rm", "-f", "in"])
	fv2 = headerHash.iatHeaderHash(file+'OutH')
	#call(["rm", "-f", "outH"])
	fv3 = byteStats.byteCounterAndEntropy(file)
	fv4 = stringHash.stringHash(file+"OutS")
	#call(["rm", "-f", "outS"])
	call(["./removeTempFiles.sh", file])

	fv = fv1
	i = 1
	for j in range(0, 256):
		fv[256*i+j] = fv2[j]

	i = i+1

	for j in range(0, 256):
		fv[256*i+j] = fv3[j]

	i = i+1

	for j in range(0, 256):
		fv[256*i+j] = fv4[j]


	for j in range(0, 1023):
		fout.write(str(fv[j]) + ', ')

	fout.write(str(fv[1023]) + '\n')
	
fout.close

